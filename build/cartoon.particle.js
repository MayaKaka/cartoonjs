define("_27",["require","base","_17","_18","_15"],function(t){"use strict";var a=t("base"),e=t("_17"),i=t("_18"),r=t("_15"),s=a.random,n=function(){};return n.get=function(t){return n.particles[t]},n.particles={rain:{init:function(t){var a,i=t.width||300,r=t.height||150,n=t.num||60;this.data({width:i,height:r});for(var h=0;n>h;h++)a=new e({render:this.renderMode,x:s(0,i),y:-s(0,r),alpha:s(0,3)/10+.2,width:h%6===0?3:2,height:h%3===0?28:20,fill:"#ffffff"}),a.data("speed",s(0,250)+250),this.add(a)},update:function(t){for(var a,e,i,r=this.children,n=(this.data("width"),this.data("height")),h=0,d=r.length;d>h;h++)a=r[h],e=a.data("speed"),i=a.y+e*t/1e3,i>n&&(i=-s(0,n)),a.style("y",i)}},snow:{init:function(t){var a,e,n,h,d,o,l=t.width||300,m=t.height||150,p=t.num||30,c=t.rate||1,f=t.duration,u=t.minScale||.5,y=t.maxScale||1,v=t.spriteSheet||t.ss;this._deltaTime=0,this.data({width:l,height:m,duration:f});for(var g=function(t){return e=s(0,l),n=-s(0,m),v?(d=s(0,v.frames.length-1),o=v.frames[d],new r({render:t,x:e,y:n,alpha:s(8,10)/10,image:v.images[o[4]],rect:o,transform:{scale:s(10*u,10*y)/10}})):new i({render:t,x:e,y:n,alpha:s(6,8)/10,radius:s(4,8),fill:"#ffffff"})},M=0;p>M;M++)h=s(25,50)*c,a=g(this.renderMode),a.data({speedX:h*s(-6,6)/10,speedY:h,speedR:s(30,50)*c,defaultA:a.alpha}),this.add(a)},update:function(t){for(var a,e,i,r,n,h,d,o=this.children,l=this.data("width"),m=this.data("height"),p=.15*m>80?80:.15*m,c=this.data("duration"),f=0,u=o.length;u>f;f++)a=o[f],e=a.data("speedX"),i=a.data("speedY"),r=a.data("speedR"),n=a.x+e*t/1e3,h=a.y+i*t/1e3,d=a.transform.rotate+r*t/1e3,h>m||n>l?this._deltaTime>c?(this.remove(a),f--,u--):(n=s(0,l),h=-s(0,m),a.style("alpha",a.data("defaultA"))):h>m-p&&a.style("alpha",a.alpha-t/1500),a.style({x:n,y:h,transform:{rotate:d}});this._deltaTime+=t}},smoke:{init:function(t){var a=this,e=this.renderMode,i=t.height,s=0,n=i,h="images/smoke.png",d=this.particles=[];this.data("spawn_time",0),this.spawn=function(){var t=Math.floor(6*Math.random())+60,i=new r({renderMode:e,x:s-t/2,y:n,width:t,height:t,image:h,scaleToFit:!0,alpha:.8});i.data({life_time:0,now_size:1,start_size:30,vr:(3*Math.random()+3)/10,vsize:(3*Math.random()+3)/10,vx:0,vy:-Math.floor(4*Math.random()+20)/10}),i.style({transform:{rotate:Math.floor(360*Math.random())}}),d.push(i),a.add(i)}},update:function(t){var a,e,i,r,s,n,h,d,o,l,m,p=this.particles,c=this.data("spawn_time");c>90?(this.spawn(),this.data("spawn_time",0)):this.data("spawn_time",c+t);for(var f=p.length-1;f>=0;f--)a=p[f],e=a.data("life_time"),e>6e3?(p.splice(f,1),this.remove(a)):(d=a.x,o=a.y,l=a.transform.rotate,m=a.alpha,i=a.width,r=a.data("vx"),s=a.data("vy"),n=a.data("vr"),h=a.data("vsize"),i+=h,a.data("life_time",e+t),a.style({x:d+r,y:o+s,size:{width:i,height:i},transform:{rotate:l-n},alpha:m-.0035}))}},fireworks:{init:function(t){var a,e,i,n,h,d,o=t.ss,l=0,m=0;this.particles=[];for(var p=0;p<(t.num||60);p++)h=s(0,o.frames.length-1),d=o.frames[h],a=new r({renderMode:this.renderMode,image:o.images[d[4]],sourceRect:d}),e=360*Math.random()*Math.PI/180,i=360*Math.random(),n=.1*Math.random()+.2,a.data({angle:e,speed:n}),a.style({x:l,y:m,transform:{rotate:i}}),this.add(a),this.particles.push(a)},update:function(t){for(var a,e,i,r,s,n,h,d,o,l=this.particles,m=0,p=l.length;p>m;m++)a=l[m],e=a.data("angle"),i=a.data("speed"),r=a.x,s=a.y,n=a.alpha,h=i*t,d=h*Math.cos(e),o=h*Math.sin(e),r+=d,s+=o,a.style({x:r,y:s,alpha:n-.01});0>=n&&(this.stop(),this.trigger({type:"animationend"}))}},boom:{init:function(t){var a,e,r,n,h=(t.width||300,t.height||150,t.spriteSheet||t.ss,t.vx||0),d=t.vy||0;this.particles=[];for(var o=0,l=t.num||30;l>o;o++)e=s(0,10)/10+1,r=Math.random()*Math.PI*2,n=15*Math.random(),a=new i({renderMode:this.renderMode,x:0,y:0,transform:{scale:e,rotate:s(0,360)},radius:3,fill:"#ffdd00"}),a.data({vx:Math.cos(r)*n+h,vy:Math.sin(r)*n+d}),this.add(a),this.particles.push(a)},update:function(){for(var t,a,e,i,r,s=this.particles,n=0,h=s.length;h>n;n++)t=s[n],i=t.data("vx"),r=t.data("vy"),a=t.x+i,e=t.y+r,i*=.99,r=.99*(r+.5),t.style({x:a,y:e}),t.data({vx:i,vy:r}),(t.y>500||Math.abs(t.x)>500)&&(this.remove(t),s.splice(n,1),n--,h--);0===h&&(this.stop(),this.trigger({type:"animationend"}))}}},n}),define("_28",["require","_21","_27"],function(t){"use strict";var a=t("_21"),e=t("_27"),i=a.AnimatedObject.extend({type:"ParticleSystem",emitter:null,particles:null,_deltaTime:-1,init:function(t){this._super(t),this._initParticle(t.particle||t.p)},update:function(t){this._paused||this.emitter&&this.emitter.update.call(this,t)},_initParticle:function(t){var a=t.type,i=a?e.get(a):t;i&&i.init&&i.update&&(i.init.call(this,t),this.emitter=i,this.play())}});return i}),define("cartoon.particle",["require","cartoon","_28"],function(t){"use strict";var a=t("cartoon");return a.extend({ParticleSystem:t("_28")}),a});