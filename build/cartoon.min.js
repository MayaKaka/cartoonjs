/*! cartoonjs 2014-11-16 */
define("base",[],function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1}),Element.prototype.addEventListener||(Element.prototype.addEventListener=Element.prototype.attachEvent);var a=function(a){for(var b in a)this[b]=a[b]};return{version:"0.0.0",expand:a}}),define("core/Class",[],function(){var a=function(){},b=!1,c=/xyz/.test(function(){})?/\b_super\b/:/.*/;return a.extend=function(d){var e=this,f=this.prototype,g=function(){!b&&this.init&&this.init.apply(this,arguments)};e!==a&&(b=!0,g.prototype=new e),b=!1;var h=g.prototype;for(var i in d)h[i]="function"==typeof f[i]&&"function"==typeof d[i]&&c.test(d[i])?function(a,b){return function(){var c=this._super;this._super=f[a];var d=b.apply(this,arguments);return this._super=c,d}}(i,d[i]):d[i];return g.extend=arguments.callee,g},a}),define("core/Ticker",["require","exports","module","core/Class"],function(a){var b=a("core/Class"),c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.setTimeout,d=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout,e=b.extend({fps:-1,interval:-1,_paused:!0,_timer:null,_targets:null,init:function(a){a?(this.interval=a,this.fps=(1e3/a).toFixed(2)):(this.interval=16.67,this.fps=60),this._targets=[],e._tickers.push(this)},isActive:function(){return!this._paused},start:function(){this._clearTimer(),this._paused=!1,this._setTimer()},stop:function(){this._paused=!0,this._clearTimer()},has:function(a){for(var b=this._targets,c=b.length-1;c>=0;c--)if(b[c]===a)return!0;return!1},add:function(a){a.update instanceof Function&&(a._ticker&&a._ticker.remove(a),a._ticker=this),this._targets.push(a)},remove:function(a){for(var b=this._targets,c=b.length-1;c>=0;c--)if(b[c]===a){b.splice(c,1),a._ticker&&(a._ticker=null);break}},removeAll:function(){for(var a,b=this._targets;b.length;)a=b.pop(),a._ticker&&(a._ticker=null)},_clearTimer:function(){this._timer&&(d(this._timer),this._timer=null)},_setTimer:function(){var a,b,d=this,e=d.interval,f=c===window.setTimeout,g=0,h=0,i=0,j=0,k=.97*(e-1),l=[],m=function(){return f?!0:0===h?(h=(new Date).getTime(),!0):(i=(new Date).getTime(),i-h>k?(h=i,!0):!1)},n=function(){if(0===g)g=(new Date).getTime();else{if(i=(new Date).getTime(),j=i-g,g=i,l.push(j),l.length>=10){l.splice(0,5),a=0,b=l.length;for(var c=0;b>c;c++)a+=l[c];d.fps=Math.floor(1e3*b/a)}j>3*e&&(j=e)}d._exec(j)},o=function(){m()&&n(),d._clearTimer(),d._paused||(d._timer=c(o,e))};o()},_exec:function(a){for(var b,c=this._targets,d=0,e=c.length;e>d&&!this._paused;d++)b=c[d],b&&(b.update instanceof Function?b.update(a):b instanceof Function&&b(a))}});return e._tickers=[],e.destroyAll=function(){for(var a,b=this._tickers,c=0,d=b.length;d>c;c++)a=b[c],a.isActive()&&a.stop()},e}),define("core/EventDispatcher",["require","exports","module","core/Class"],function(a){var b=a("core/Class"),c=b.extend({_listeners:null,on:function(a,b,c){this.addEventListener(a,b),"string"==typeof c&&(this._listeners["@"+a+"."+c]=[b])},off:function(a,b){var c;"string"==typeof b?(b="@"+a+"."+b,c=this._listeners[b][0],this._listeners[b]=null):c=b,this.removeEventListener(a,c)},trigger:function(a){this.dispatchEvent(a)},addEventListener:function(a,b){this._listeners||(this._listeners={});var c=this._listeners,d=c[a];d||(d=c[a]=[]),-1===d.indexOf(b)&&d.push(b)},hasEventListener:function(a,b){if(!this._listeners)return!1;var c=this._listeners,d=c[a];return d?b?-1!==d.indexOf(b):d.length>0:!1},removeEventListener:function(a,b){if(this._listeners){var c=this._listeners,d=c[a];if(d)if(b){var e=d.indexOf(b);-1!==e&&d.splice(e,1)}else istenerArray.length>0&&(c[a]=[])}},dispatchEvent:function(a){if(this._listeners){var b=this._listeners,c=b[a.type];if(c){a.target=this;for(var d=0,e=c.length;e>d;d++)c[d].call(this,a)}}}});return c}),define("core/Loader",["require","exports","module","core/EventDispatcher"],function(a){var b=a("core/EventDispatcher"),c=b.extend({regexpImage:/\.jpg$|\.png$|\.gif$/,regexpJson:/\.json$/,_resources:null,_loadQueue:null,_loadQueueLength:-1,init:function(){this._resources={},this._loadQueue=[]},load:function(a){for(var b,c,d=this._loadQueueLength=a.length,e=0;d>e;e++)b=a[e],c=this.regexpImage.test(b)?"image":this.regexpJson.test(b)?"json":"text",this._loadQueue.push({type:c,url:b});d&&this._loadNext()},loadFile:function(a){"image"===a.type?this._loadImage(a):this._loadJson(a)},hasItem:function(a){return a in this._resources},getItem:function(a){return this._resources[a]},setItem:function(a,b){this._resources[a]=b},_loadComplete:function(a){var b=1;this._loadQueueLength&&(b=1-this._loadQueue.length/this._loadQueueLength,this.trigger({type:"progress",progress:b,file:a})),1>b?this._loadNext():(this._loadQueueLength=0,this.trigger({type:"complete",file:a}))},_loadNext:function(){this.loadFile(this._loadQueue.shift())},_loadImage:function(a){var b=this,c=new Image;c.src=a.url,c.onload=function(){b._loadComplete(c)},this.setItem(a.url,c)},_loadJson:function(a){var b,c,d=this,e=new XMLHttpRequest;e.onreadystatechange=function(){e.readyState===e.DONE&&(200===e.status||0===e.status)&&(c=e.responseText,c&&(b="json"===a.type?JSON.parse(c):c,d.setItem(a.url,b),d._loadComplete(b)))},e.open("GET",a.url,!0),e.send(null)}});return c}),define("core/Preload",["require","exports","module","core/Loader"],function(a){var b=a("core/Loader");return new b}),define("display/StyleSheet",["require","exports","module","core/Preload"],function(a){var b=a("core/Preload"),c=document.createElement("div").style,d=""===c.webkitTransform?"webkit":""===c.WebkitTransform?"Webkit":""===c.msTransform?"ms":""===c.MozTransform?"Moz":"ct",e=navigator.userAgent.indexOf("MSIE 9.0")>0,f="ct"===d&&""===c.filter,g=/^\#|^rgb|^rgba|black|red|green|blue|yellow|orange|pink|purple|gray/,h=/^top|^right|^bottom|^left|^center/,i=/\.jpg$|\.png$|\.gif$/,j=function(){};return j.has=function(a){return!!j.styles[a]},j.init=function(a,b){var c=j.styles[b];return c&&c.init?c.init.call(a,b):void 0},j.get=function(a,b){var c=j.styles[b];return c?c.get.call(a,b):void 0},j.set=function(a,b,c){var d=j.styles[b];d&&d.set.call(a,b,c)},j.step=function(a,b,c){var d=j.styles[b];d&&d.step&&d.step.call(a,b,c)},j.css3=function(a,b,c){var e=b.charAt(0).toUpperCase()+b.substring(1,b.length);a[d+e]=c},j.commonGet=function(a){return this[a]},j.commonSet=function(a,b){this[a]=b},j.commonStep=function(a,b){var c=b.start,d=b.end,e=b.pos,f=(d-c)*e+c;this.style(a,f)},j.commonSteps=function(a,b){var c=b.pos,d=b.start,e=b.end,f={};for(var g in e)f[g]=(e[g]-d[g])*c+d[g];this.style(a,f)},j.toRGBA=function(a){var b={r:0,g:0,b:0,a:1};return a.indexOf("rgb")>-1?(a=a.replace(/rgb\(|rgba\(|\)/g,""),a=a.split(","),b.r=parseInt(a[0]),b.g=parseInt(a[1]),b.b=parseInt(a[2]),4===a.length&&(b.a=a[3])):a.indexOf("#")>-1&&(4===a.length?(b.r=a.substring(1,2),b.g=a.substring(2,3),b.b=a.substring(3,4),b.r=parseInt(b.r+b.r,16),b.g=parseInt(b.g+b.g,16),b.b=parseInt(b.b+b.b,16)):(b.r=parseInt(a.substring(1,3),16),b.g=parseInt(a.substring(3,5),16),b.b=parseInt(a.substring(5,7),16))),b},j.toColor=function(a){var b=a.r.toString(16),c=a.g.toString(16),d=a.b.toString(16);return 1===b.length&&(b="0"+b),1===c.length&&(c="0"+c),1===d.length&&(d="0"+d),"#"+b+c+d},j.toGradient=function(a){if("string"==typeof a){a=a.split(/\,#|\,rgb/);for(var b=1,c=a.length;c>b;b++)a[b]=(a[b].indexOf("(")>-1?"rgb":"#")+a[b]}return a},j.stepColor=function(a,b,c){b=j.toRGBA(b),c=j.toRGBA(c);var d={};for(var e in c)d[e]=Math.floor((c[e]-b[e])*a+b[e]);return j.toColor(d)},j.styles={x:{get:j.commonGet,set:function(a,b){if(this[a]=b,0===this.renderMode){var c=this.elemStyle;c.position="absolute",c.left=b+"px"}},step:j.commonStep},y:{get:j.commonGet,set:function(a,b){if(this[a]=b,0===this.renderMode){var c=this.elemStyle;c.position="absolute",c.top=b+"px"}},step:j.commonStep},z:{get:j.commonGet,set:function(a,b){this[a]=b,this.style("transform3d",{perspective:b})},step:j.commonStep},pos:{get:function(){return{x:this.x,y:this.y}},set:function(a,b){if(void 0!==b.x&&(this.x=b.x),void 0!==b.y&&(this.y=b.y),0===this.renderMode){var c=this.elemStyle;c.position="absolute",c.left=this.x+"px",c.top=this.y+"px"}},step:j.commonSteps},width:{get:j.commonGet,set:function(a,b){this[a]=b,0===this.renderMode&&(this.useElemSize?this.elem.width=b:this.elemStyle.width=b+"px")},step:j.commonStep},height:{get:j.commonGet,set:function(a,b){this[a]=b,0===this.renderMode&&(this.useElemSize?this.elem.height=b:this.elemStyle.height=b+"px")},step:j.commonStep},size:{get:function(){return{width:this.width,height:this.height}},set:function(a,b){if(void 0!==b.width&&(this.width=b.width),void 0!==b.height&&(this.height=b.height),0===this.renderMode)if(this.useElemSize){var c=this.elem;c.width=this.width,c.height=this.height}else{var d=this.elemStyle;d.width=this.width+"px",d.height=this.height+"px"}},step:j.commonSteps},transform:{init:function(){return this.transform={translateX:0,translateY:0,rotate:0,scale:1,scaleX:1,scaleY:1,skewX:0,skewY:0,originX:.5,originY:.5},this.transform},get:function(a){return this.transform||j.init(this,a)},set:function(a,b){var c=j.get(this,a);for(var d in b)this._updateTransform(d,b[d]);if(0===this.renderMode){var e=this.elemStyle;if(f){var g=this.elem,h=e.filter,i=/Matrix([^)]*)/,k=this._updateMatrix2D(!0),l=["Matrix(M11="+k.a,"M12="+k.b,"M21="+k.c,"M22="+k.d,"SizingMethod='auto expand'"].join(",");e.filter=i.test(h)?h.replace(i,l):"progid:DXImageTransform.Microsoft."+l+") "+h,e.marginLeft=c.translateX+(g.clientWidth-g.offsetWidth)*c.originX+"px",e.marginTop=c.translateY+(g.clientHeight-g.offsetHeight)*c.originY+"px"}else j.css3(e,"transform",this._mergeTransformText()),("originX"in b||"originY"in b)&&j.css3(e,"transformOrigin",100*c.originX+"% "+100*c.originY+"%")}},step:j.commonSteps},transform3d:{init:function(){if(this.transform3d={perspective:0,translateX:0,translateY:0,translateZ:0,rotateX:0,rotateY:0,rotateZ:0,scaleX:1,scaleY:1,scaleZ:1,originX:.5,originY:.5,originZ:.5},0===this.renderMode){var a=this.elemStyle;j.css3(a,"transformStyle","preserve-3d"),j.css3(a,"backfaceVisibility","visible")}return this.transform3d},get:function(a){return this.transform3d||j.init(this,a)},set:function(a,b){var c=j.get(this,a);for(var d in b)this._updateTransform3D(d,b[d]);if(0===this.renderMode){var e=this.elemStyle;j.css3(e,"transform",this._mergeTransform3DText()),("originX"in b||"originY"in b||"originZ"in b)&&j.css3(e,"transformOrigin",100*c.originX+"% "+100*c.originY+"%")}},step:j.commonSteps},visible:{get:j.commonGet,set:function(a,b){this[a]=b,0===this.renderMode&&(this.elemStyle.display=b?"block":"none")}},overflow:{get:j.commonGet,set:function(a,b){this[a]=b,0===this.renderMode&&(this.elemStyle.overflow=b)}},alpha:{get:j.commonGet,set:function(a,b){if(b=b>=0?b:0,this[a]=b,0===this.renderMode){var c=this.elemStyle;if(f){var d=c.filter,e=/alpha\(opacity=([^)]*)/,g="alpha(opacity="+100*b;c.filter=e.test(d)?d.replace(e,g):d+" "+g+")"}else c.opacity=b}},step:j.commonStep},shadow:{get:j.commonGet,set:function(a,b){"string"==typeof b&&(b=b.split("px "),b={offsetX:parseFloat(b[0]),offsetY:parseFloat(b[1]),blur:parseFloat(b[2]),color:b[3]}),this[a]=b,0===this.renderMode&&(this.elemStyle.boxShadow=b.offsetX+"px "+b.offsetY+"px "+b.blur+"px "+b.color)},step:j.commonSteps},fill:{get:function(){return this.fillColor||this.fillGradient||this.fillImage},set:function(a,b){g.test(b)?this.style("fillColor",b):h.test(b)?this.style("fillGradient",b):i.test(b)&&this.style("fillImage",b)},step:function(a,b){var c=b.end;g.test(c)?this._stepStyle("fillColor",b):h.test(c)&&this._stepStyle("fillGradient",b)}},fillColor:{get:j.commonGet,set:function(a,b){this.fillGradient=this.fillImage=null,this[a]=b,0===this.renderMode&&(this.elemStyle.backgroundColor=b,this.elemStyle.backgroundImage="")},step:function(a,b){this.style(a,j.stepColor(b.pos,b.start,b.end))}},fillGradient:{get:j.commonGet,set:function(a,b){if(this.fillColor=this.fillImage=null,this[a]=b=j.toGradient(b),0===this.renderMode){var c,d=this.elemStyle;if(f||e){var g=d.filter,h=/gradient([^)]*)/;c="gradient(GradientType=0,startColorstr='"+b[1]+"', endColorstr='"+b[2]+"'",d.filter=h.test(g)?g.replace(h,c):g+" progid:DXImageTransform.Microsoft."+c+")"}else c="center"===b[0]?"radial-gradient(circle,"+b[1]+","+b[2]+")":"linear-gradient("+b[0]+","+b[1]+","+b[2]+")",d.backgroundImage="-webkit-"+c,d.backgroundImage="-ms-"+c,d.backgroundImage="-moz-"+c}},step:function(a,b){var c=b.start,d=b.end,d=j.toGradient(d),e=b.pos,f=[d[0]];f.push(j.stepColor(e,c[1],d[1])),f.push(j.stepColor(e,c[2],d[2])),this.style(a,f)}},fillImage:{get:j.commonGet,set:function(a,c){this.fillColor=this.fillGradient=null,0===this.renderMode?this.elemStyle.backgroundImage="url("+c+")":(b.hasItem(c)||b.loadFile({type:"image",url:c}),c=b.getItem(c)),this[a]=c}},stroke:{get:function(){return this.strokeColor},set:function(a,b){this.style("strokeColor",b)},step:function(a,b){this._stepStyle("strokeColor",b)}},strokeColor:{get:j.commonGet,set:function(a,b){if(this[a]=b,0===this.renderMode){var c=this.elemStyle;c.borderColor=b,c.borderStyle="solid"}},step:function(a,b){this.style(a,j.stepColor(b.pos,b.start,b.end))}},lineWidth:{get:j.commonGet,set:function(a,b){this[a]=b,0===this.renderMode&&(this.elemStyle.borderWidth=b+"px")},step:j.commonStep},radius:{get:j.commonGet,set:function(a,b){if(this[a]=b,this.width=this.height=2*b,0===this.renderMode){var c=this.elemStyle;c.borderRadius="50%",c.width=c.height=this.width+"px"}},step:j.commonStep},angle:{get:j.commonGet,set:j.commonSet,step:j.commonStep},radiusXY:{get:function(){return{radiusX:this.radiusX,radiusY:this.radiusY}},set:function(a,b){if(void 0!==b.radiusX&&(this.radiusX=b.radiusX,this.width=2*this.radiusX),void 0!==b.radiusY&&(this.radiusY=b.radiusY,this.height=2*this.radiusY),0===this.renderMode){var c=this.elemStyle;c.borderRadius="50%",c.width=this.width+"px",c.height=this.height+"px"}},step:j.commonSteps},font:{get:j.commonGet,set:j.commonSet,step:j.commonStep},textColor:{get:j.commonGet,set:j.commonSet,step:j.commonStep}},j}),define("core/UserData",["require","exports","module","core/Class"],function(a){var b=a("core/Class"),c=b.extend({_data:null,init:function(){this._data={}},get:function(a){return this._data[a]},set:function(a,b){return this._data[a]=b,b}});return c}),define("core/Matrix2D",["require","exports","module","core/Class"],function(a){var b=a("core/Class"),c=Math.PI/180,d=b.extend({a:1,b:0,c:0,d:1,tx:0,ty:0,prepend:function(a,b,c,d,e,f){var g=this.tx;if(1!=a||0!=b||0!=c||1!=d){var h=this.a,i=this.c;this.a=h*a+this.b*c,this.b=h*b+this.b*d,this.c=i*a+this.d*c,this.d=i*b+this.d*d}return this.tx=g*a+this.ty*c+e,this.ty=g*b+this.ty*d+f,this},append:function(a,b,c,d,e,f){var g=this.a,h=this.b,i=this.c,j=this.d;return this.a=a*g+b*i,this.b=a*h+b*j,this.c=c*g+d*i,this.d=c*h+d*j,this.tx=e*g+f*i+this.tx,this.ty=e*h+f*j+this.ty,this},prependMatrix:function(a){return this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty),this},appendMatrix:function(a){return this.append(a.a,a.b,a.c,a.d,a.tx,a.ty),this},prependTransform:function(a,b,d,e,f,g,h){if(f%360)var i=f*c,j=Math.cos(i),k=Math.sin(i);else j=1,k=0;return g||h?(g*=c,h*=c,this.prepend(j*d,k*d,-k*e,j*e,0,0),this.prepend(Math.cos(h),Math.sin(h),-Math.sin(g),Math.cos(g),a,b)):this.prepend(j*d,k*d,-k*e,j*e,a,b),this},appendTransform:function(a,b,d,e,f,g,h){if(f%360)var i=f*c,j=Math.cos(i),k=Math.sin(i);else j=1,k=0;return g||h?(g*=c,h*=c,this.append(Math.cos(h),Math.sin(h),-Math.sin(g),Math.cos(g),a,b),this.append(j*d,k*d,-k*e,j*e,0,0)):this.append(j*d,k*d,-k*e,j*e,a,b),this},rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this},skew:function(a,b){return a*=c,b*=c,this.append(Math.cos(b),Math.sin(b),-Math.sin(a),Math.cos(a),0,0),this},scale:function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},translate:function(a,b){return this.tx+=a,this.ty+=b,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},isIdentity:function(){return 0==this.tx&&0==this.ty&&1==this.a&&0==this.b&&0==this.c&&1==this.d},transformPoint:function(a,b,c){return c=c||{},c.x=a*this.a+b*this.c+this.tx,c.y=a*this.b+b*this.d+this.ty,c}});return d}),define("animation/Ease",["require","exports","module"],function(){var a=function(){};a.get=function(a){return b[a]||b.linear};var b={none:function(a){return a>=1?1:0},linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin(2*(b*e-f)*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=.3*e*1.5),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return 1>b?-.5*h*Math.pow(2,10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,c,d,e,f){return e-b.easeOutBounce(a,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?7.5625*d*b*b+c:2/2.75>b?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:2.5/2.75>b?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,c,d,e,f){return f/2>c?.5*b.easeInBounce(a,2*c,0,e,f)+d:.5*b.easeOutBounce(a,2*c-f,0,e,f)+.5*e+d},easeIn:function(a,c,d,e,f){return b.easeInQuad(a,c,d,e,f)},easeOut:function(a,c,d,e,f){return b.easeOutQuad(a,c,d,e,f)},easeInOut:function(a,c,d,e,f){return b.easeInOutQuad(a,c,d,e,f)},expoIn:function(a,c,d,e,f){return b.easeInExpo(a,c,d,e,f)},expoOut:function(a,c,d,e,f){return b.easeOutExpo(a,c,d,e,f)},expoInOut:function(a,c,d,e,f){return b.easeInOutExpo(a,c,d,e,f)},bounceIn:function(a,c,d,e,f){return b.easeInBounce(a,c,d,e,f)},bounceOut:function(a,c,d,e,f){return b.easeOutBounce(a,c,d,e,f)},bounceInOut:function(a,c,d,e,f){return b.easeInOutBounce(a,c,d,e,f)},elasIn:function(a,c,d,e,f){return b.easeInElastic(a,c,d,e,f)},elasOut:function(a,c,d,e,f){return b.easeOutElastic(a,c,d,e,f)},elasInOut:function(a,c,d,e,f){return b.easeInOutElastic(a,c,d,e,f)},backIn:function(a,c,d,e,f){return b.easeInBack(a,c,d,e,f)},backOut:function(a,c,d,e,f){return b.easeOutBack(a,c,d,e,f)},backInOut:function(a,c,d,e,f){return b.easeInOutBack(a,c,d,e,f)}};return a.easing=b,jQuery&&jQuery.extend(jQuery.easing,b),a}),define("animation/Tween",["require","exports","module","core/Class","animation/Ease"],function(a){var b=a("core/Class"),c=a("animation/Ease"),d=b.extend({_done:!1,_target:null,_deltaTime:-1,_start:null,_end:null,_duration:null,_easing:null,_callback:null,_onframe:null,init:function(a,b){this._target=a,this._deltaTime=0;var d=b.start,e=b.end;if(d)a.style(d);else{d={};for(var f in e)d[f]=this._clone(a.style(f))}this._start=d,this._end=e,this._duration=b.duration,this._easing=c.get(b.easing),this._callback=b.callback,this._onframe=b.onframe},update:function(a){if(!this._done){var b=this._target,c=this._start,d=this._end,e=this._duration,f=this._easing,g=this._deltaTime,h=g/e,i=f(h,h,0,1,1);for(var j in d)b._stepStyle(j,{pos:i,start:c[j],end:d[j]});if(this._onframe&&this._onframe(h,i),g===e)this._done=!0,this._callback&&this._callback();else{var k=g+a;this._deltaTime=k>e?e:k}}},_clone:function(a){var b;if("object"==typeof a){b={};for(var c in a)b[c]=this._clone(a[c])}else b=a;return b}});return d._tweens=[],d._currentTarget=null,d.update=function(a){for(var b=this._tweens,c=b.length-1;c>=0;c--)b[c]._done&&b.splice(c,1);for(var c=0,d=b.length;d>c;c++)b[c].update(a)},d.get=function(a){return this._currentTarget=a,this},d.addTween=function(a,b,c,e,f){var g=this._currentTarget,h=g.data("fx_queue");"number"==typeof a&&(e=b,b=a,a={},c="none");var i=function(){e&&e(),h=g.data("fx_queue"),h&&h.length>0?h.shift()():g.data("fx_queue",null)},j=function(){var e=new d(g,{start:null,end:a,duration:b||300,easing:c||"linear",callback:i,onframe:f});d._tweens.push(e)};h?h.push(j):(j(),g.data("fx_queue",[]))},d}),define("display/DisplayObject",["require","exports","module","core/EventDispatcher","core/UserData","core/Matrix2D","display/StyleSheet","animation/Tween"],function(a){var b=a("core/EventDispatcher"),c=a("core/UserData"),d=a("core/Matrix2D"),e=a("display/StyleSheet"),f=a("animation/Tween"),g=document.createElement("div"),h=!!document.createElement("canvas").getContext,i=b.extend({type:"DisplayObject",x:0,y:0,width:0,height:0,visible:!0,overflow:"visible",alpha:1,shadow:null,transform:null,transform3d:null,parent:null,children:null,elem:null,elemStyle:null,renderMode:0,blendMode:"source-over",mouseEnabled:!0,updaters:null,_tagName:"div",_matrix2d:null,_userData:null,init:function(a){if(a||(a={}),this.renderMode=void 0!==a.renderMode?a.renderMode:this.renderMode,0===this.renderMode){var b=a.elem;"string"==typeof b&&(/^<.+>$/.test(b)?(g.innerHTML=b,b=g.remove(g.children[0])):b=document.querySelector?document.querySelector(b):null),this.elem=b||document.createElement(this._tagName),this.elem.displayObj=this,this.elemStyle=this.elem.style,window.jQuery&&(this.$=jQuery(this.elem))}else a.blendMode&&(this.blendMode=a.blendMode);this.children=[],this.updaters=[],this._matrix2d=new d,this._userData=new c;for(var f in a)e.has(f)&&this.style(f,a[f]);this.transform||e.init(this,"transform")},add:function(a){a.parent&&a.parent.remove(a),a.parent=this,this.children.push(a),0===a.renderMode&&0===this.renderMode&&this.elem.appendChild(a.elem),this._addUpdater(a)},remove:function(a){if(a.parent===this){a.parent=null;var b=this.children,c=b.indexOf(a);b.splice(c,1),0===a.renderMode&&0===this.renderMode&&this.elem.removeChild(a.elem),this._removeUpdater(a)}},removeAll:function(){for(var a,b,c=this.children;c.length;)a=c.length-1,b=c[a],b.parent=null,c.splice(a,1),0===b.renderMode&&0===this.renderMode&&this.elem.removeChild(b.elem),this._removeUpdater(b)},each:function(a){for(var b=this.children,c=0,d=b.length;d>c;c++)a(b[c],c)},enable:function(a){this.mouseEnabled=a?!0:!1,0===this.renderMode&&(this.elemStyle.pointerEvents=a?"auto":"none")},style:function(a,b){if(void 0===b){if("object"!=typeof a)return e.get(this,a);for(var c in a)e.set(this,c,a[c])}else e.set(this,a,b)},data:function(a,b){if(void 0===b){if("object"!=typeof a)return this._userData.get(a);for(var c in a)this._userData.set(c,a[c])}else this._userData.set(a,b)},to:function(a,b,c,d,e){return f.get(this).addTween(a,b,c,d,e),this},draw:function(a){if(this.children.length){"hidden"===this.overflow;for(var b,c=this.children,d=0,e=c.length;e>d;d++)b=c[d],b.visible&&b._drawCanvas(a)}},cache:function(){if(h){var a=document.createElement("canvas");a.width=this.width,a.height=this.height,this.draw(a.getContext("2d")),this._cacheCanvas=a}},uncache:function(){this._cacheCanvas=null},_stepStyle:function(a,b){e.step(this,a,b)},_isUpdater:function(a){return a.update||a.hasEventListener("update")||"DisplayObject"===a.type},_addUpdater:function(a){this._isUpdater(a)&&this.updaters.push(a)},_removeUpdater:function(a){if(this._isUpdater(a)){var b=this.updaters,c=b.indexOf(a);b.splice(c,1)}},_eachUpdaters:function(a){for(var b,c=this.updaters,d=0,e=c.length;e>d;d++)b=c[d],b.hasEventListener("update")&&b.trigger({type:"update",delta:a}),b.update?b.update(a):"DisplayObject"===b.type&&b._eachUpdaters(a)},_updateTransform:function(a,b){"scale"===a?this.transform.scale=this.transform.scaleX=this.transform.scaleY=b:a in this.transform&&(this.transform[a]=b)},_updateTransform3D:function(a,b){a in this.transform3d&&(this.transform3d[a]=b)},_mergeTransformText:function(){var a=this.transform,b="";return(0!==a.translateX||0!==a.translateY)&&(b+="translate("+a.translateX+"px,"+a.translateY+"px)"),0!==a.rotate&&(b+=" rotate("+a.rotate+"deg)"),(1!==a.scaleX||1!==a.scaleY)&&(b+=" scale("+a.scaleX+","+a.scaleY+")"),(0!==a.skewX||0!==a.skewY)&&(b+=" skew("+a.skewX+"deg,"+a.skewY+"deg)"),b},_mergeTransform3DText:function(){var a=this.transform3d,b="";return 0!==a.perspective&&(b+="perspective("+a.perspective+"px)"),(0!==a.translateX||0!==a.translateY||0!==a.translateZ)&&(b+=" translate3d("+a.translateX+"px,"+a.translateY+"px,"+a.translateZ+"px)"),0!==a.rotateX&&(b+=" rotateX("+a.rotateX+"deg)"),0!==a.rotateY&&(b+=" rotateY("+a.rotateY+"deg)"),0!==a.rotateZ&&(b+=" rotateZ("+a.rotateZ+"deg)"),(1!==a.scaleX||1!==a.scaleY||1!==a.scaleZ)&&(b+=" scale3d("+a.scaleX+","+a.scaleY+","+a.scaleZ+")"),b},_drawCanvas:function(a){a.save(),this._updateCanvasContext(a),this._cacheCanvas?a.drawImage(this._cacheCanvas,0,0):this.draw(a),a.restore()},_updateCanvasContext:function(a){var b=this._updateMatrix2D(),c=this._getAnchorX(),d=this._getAnchorY(),e=this.shadow;0===c&&0===d?a.transform(b.a,b.b,b.c,b.d,b.tx,b.ty):(a.transform(b.a,b.b,b.c,b.d,b.tx+c,b.ty+d),a.transform(1,0,0,1,-c,-d)),a.globalAlpha*=this.alpha,a.globalCompositeOperation=this.blendMode,e&&(a.shadowOffsetX=e.offsetX,a.shadowOffsetY=e.offsetY,a.shadowBlur=e.blur,a.shadowColor=e.color)},_getAnchorX:function(){return this.width*this.transform.originX},_getAnchorY:function(){return this.height*this.transform.originY},_updateMatrix2D:function(a){var b=this._matrix2d.identity(),c=this.transform;return a?b.rotate(-c.rotate%360*d.DEG_TO_RAD).scale(c.scaleX,c.scaleY):b.appendTransform(this.x+c.translateX,this.y+c.translateY,c.scaleX,c.scaleY,c.rotate,c.skewX,c.skewY)}});return i.setRenderMode=function(a){i.prototype.renderMode="canvas"===a||1===a?1:0},i}),define("display/Container",["require","exports","module","display/DisplayObject"],function(a){var b=a("display/DisplayObject"),c=b.extend({type:"Container",renderMode:0,init:function(a){this._super(a),this._initEvents()},update:function(a){this._eachUpdaters(a)},_initEvents:function(){var a,b,c,d,e,f,g=this,h=this.elem,i=function(h){h.preventDefault(),a=g._getMouseX(h),b=g._getMouseY(h),c=g._hitTest(h.target)||g,g._triggerEvent("mousedown",c,a,b),d=!1,e=a,f=b},j=function(e){e.preventDefault(),g._triggerEvent("mouseup",c,a,b),d||g._triggerEvent("click",c,a,b),c=null},k=function(h){h.preventDefault(),a=g._getMouseX(h),b=g._getMouseY(h),g._triggerEvent("mousemove",c,a,b),!d&&(Math.abs(a-e)>3||Math.abs(b-f)>3)&&(d=!0)};"ontouchstart"in window?(h.addEventListener("touchstart",i,!1),h.addEventListener("touchend",j,!1),h.addEventListener("touchmove",k,!1)):(h.addEventListener("mousedown",i,!1),h.addEventListener("mouseup",j,!1),h.addEventListener("mousemove",k,!1))},_getMouseX:function(a){var b=a.touches?a.touches[0]:a,c=this.elem.getBoundingClientRect().left;return b.clientX-c},_getMouseY:function(a){var b=a.touches?a.touches[0]:a,c=this.elem.getBoundingClientRect().top;return b.clientY-c},_triggerEvent:function(a,b,c,d){if(b)for(var e={type:a,srcTarget:b,mouseX:c,mouseY:d};b;)b.trigger(e),b=b.parent},_hitTest:function(a){for(var b;!b&&a&&a!==this.elem;)b=a.displayObj,a=a.parentNode;return b}});return c}),define("display/Canvas",["require","exports","module","display/DisplayObject","core/Matrix2D"],function(a){var b=a("display/DisplayObject"),c=a("core/Matrix2D"),d=b.extend({type:"Canvas",renderMode:0,autoUpdate:!1,useElemSize:!0,_tagName:"canvas",_context2d:null,init:function(a){this._super(a),this._initEvents(),this._context2d=this.elem.getContext("2d")},clear:function(){this._context2d.clearRect(0,0,this.width,this.height)},update:function(a){this._eachUpdaters(a);var b=this._context2d;b.clearRect(0,0,this.width,this.height),this.draw(b)},_initEvents:function(){var a,b,c,d,e,f,g=this,h=this.elem,i=function(h){h.preventDefault(),a=g._getMouseX(h),b=g._getMouseY(h),c=g._hitTest(g.children,a,b)||g,g._triggerEvent("mousedown",c,a,b),d=!1,e=a,f=b},j=function(e){e.preventDefault(),g._triggerEvent("mouseup",c,a,b),d||g._triggerEvent("click",c,a,b),c=null},k=function(h){h.preventDefault(),a=g._getMouseX(h),b=g._getMouseY(h),g._triggerEvent("mousemove",c,a,b),!d&&(Math.abs(a-e)>3||Math.abs(b-f)>3)&&(d=!0)};"ontouchstart"in window?(h.addEventListener("touchstart",i,!1),h.addEventListener("touchend",j,!1),h.addEventListener("touchmove",k,!1)):(h.addEventListener("mousedown",i,!1),h.addEventListener("mouseup",j,!1),h.addEventListener("mousemove",k,!1))},_getMouseX:function(a){return void 0===a.offsetX?a.layerX:a.offsetX},_getMouseY:function(a){return void 0===a.offsetY?a.layerY:a.offsetY},_triggerEvent:function(a,b,c,d){if(b)for(var e={type:a,srcTarget:b,mouseX:c,mouseY:d};b;)b.trigger(e),b=b.parent},_hitTest:function(a,b,c){for(var d,e=a.length-1;e>=0;e--)if(d=a[e],d.children.length){if(d=this._hitTest(d.children,b,c))return d}else if(this._hitTestMatrix(d,b,c))return d;return null},_hitTestMatrix:function(a,b,d){if(!a.visible||!a.mouseEnabled)return!1;for(var e,f,g,h=new c,i=[];a&&a!==this;)i.unshift(a),a=a.parent;h.append(1,0,0,1,-b,-d);for(var j=0,k=i.length;k>j;j++)a=i[j],g=a._matrix2d,e=a._getAnchorX(),f=a._getAnchorY(),0===e&&0===f?h.append(g.a,g.b,g.c,g.d,g.tx,g.ty):(h.append(g.a,g.b,g.c,g.d,g.tx+e,g.ty+f),h.append(1,0,0,1,-e,-f));h.invert();var l=h.tx,m=h.ty,n=a.radius,o=a.width,p=a.height;return n?n*n>=(l-n)*(l-n)+(m-n)*(m-n):o&&p?l>=0&&o>=l&&m>=0&&p>=m:!1}});return d}),define("display/Graphics2D",["require","exports","module"],function(){var a=function(){};return a.get=function(b){return a.shapes[b]},a.commonStyle=function(a,b){b.stroke&&void 0===b.lineWidth&&(b.lineWidth=1),a.style("fill",b.fill),a.style("stroke",b.stroke),a.style("lineWidth",b.lineWidth)
},a.commonDraw=function(a,b,c){b&&a.fill(),c&&a.stroke()},a.shapes={rect:{type:"rect",init:function(b){this.style("size",b),a.commonStyle(this,b)},draw:function(a){this.setFill(a)&&a.fillRect(0,0,this.width,this.height),this.setStroke(a)&&a.strokeRect(0,0,this.width,this.height)}},circle:{type:"circle",init:function(b){void 0===b.angle&&(b.angle=360),this.style("radius",b.radius),this.style("angle",b.angle),a.commonStyle(this,b)},draw:function(b){var c=this.radius,d=this.setFill(b),e=this.setStroke(b);b.beginPath(),b.arc(c,c,c,0,this.angle/360*Math.PI*2,0),this.angle<360&&b.lineTo(c,c),b.closePath(),a.commonDraw(b,d,e)}},ellipse:{type:"ellipse",init:function(b){this.style("radiusXY",b),a.commonStyle(this,b)},draw:function(b){var c=.5522848,d=this.radiusX,e=this.radiusY,f=d*c,g=e*c,h=2*d,i=2*e,j=this.setFill(b),k=this.setStroke(b);b.beginPath(),b.moveTo(0,e),b.bezierCurveTo(0,e-g,d-f,0,d,0),b.bezierCurveTo(d+f,0,h,e-g,h,e),b.bezierCurveTo(h,e+g,d+f,i,d,i),b.bezierCurveTo(d-f,i,0,e+g,0,e),b.closePath(),a.commonDraw(b,j,k)}},line:{type:"line",init:function(a){void 0===a.lineWidth&&(a.lineWidth=1),this.path=a.path,this.style("stroke",a.stroke),this.style("lineWidth",a.lineWidth)},draw:function(a){var b,c=this.path,d=this.setStroke(a);if(d&&c.length>1){a.beginPath();for(var e=0,f=c.length;f>e;e++)b=c[e],0===e?a.moveTo(b[0],b[1]):2===b.length?a.lineTo(b[0],b[1]):4===b.length?a.quadraticCurveTo(b[0],b[1],b[2],b[3]):6===b.length&&a.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5]);a.stroke()}}},ploygon:{type:"ploygon",init:function(b){this.path=b.path,a.commonStyle(this,b)},draw:function(b){var c,d=this.path,e=this.setFill(b),f=this.setStroke(b);if(d.length>2){b.beginPath();for(var g=0,h=d.length;h>g;g++)c=d[g],0===g?b.moveTo(c[0],c[1]):2===c.length?b.lineTo(c[0],c[1]):4===c.length?b.quadraticCurveTo(c[0],c[1],c[2],c[3]):6===c.length&&b.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);b.closePath(),a.commonDraw(b,e,f)}}},polyStar:{type:"polyStar",init:function(b){this.sides=b.sides,this.cohesion=b.cohesion,this.style("radius",b.radius),a.commonStyle(this,b)},draw:function(b){var c,d,e,f=this.radius,g=this.sides,h=this.cohesion,i=this.setFill(b),j=this.setStroke(b);b.beginPath();for(var k=0;g>k;k++)c=k/g*Math.PI*2,d=(1-Math.sin(c))*f,e=(1-Math.cos(c))*f,0===k?b.moveTo(d,e):b.lineTo(d,e),h&&(c+=Math.PI/g,d=(1-Math.sin(c)*h)*f,e=(1-Math.cos(c)*h)*f,b.lineTo(d,e));b.closePath(),a.commonDraw(b,i,j)}},roundRect:{type:"roundRect",init:function(){},draw:function(){}},lines:{type:"lines",init:function(a){void 0===a.lineWidth&&(a.lineWidth=1),this.paths=a.paths,this.style("stroke",a.stroke),this.style("lineWidth",a.lineWidth)},draw:function(a){var b,c,d=this.paths,e=this.setStroke(a);if(e&&d.length){a.beginPath();for(var f=0,g=d.length;g>f;f++)if(b=d[f],b.length>1)for(var h=0,i=b.length;i>h;h++)c=b[h],0===h?a.moveTo(c[0],c[1]):2===c.length?a.lineTo(c[0],c[1]):4===c.length?a.quadraticCurveTo(c[0],c[1],c[2],c[3]):6===c.length&&a.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);a.stroke()}}}},a}),define("display/Shape",["require","exports","module","display/DisplayObject","display/Graphics2D"],function(a){var b=a("display/DisplayObject"),c=a("display/Graphics2D"),d=b.extend({type:"Shape",graphics:null,snapToPixel:!0,init:function(a){this._super(a),this._initGraphics(a.graphics)},draw:function(a){this.graphics&&this.graphics.draw.call(this,a)},setFill:function(a){var b=this.fillColor,c=this.fillGradient,d=this.fillImage;if(d)d.complete&&(b=a.createPattern(d,"no-repeat"));else if(c){switch(c[0]){case"top":case"bottom":b=a.createLinearGradient(0,0,0,this.height);break;case"left":case"right":b=a.createLinearGradient(0,0,this.width,0);break;case"left top":b=a.createLinearGradient(0,0,this.width,this.height);break;case"right top":b=a.createLinearGradient(this.width,0,0,this.height);break;case"center":var e=this.width/2,f=this.height/2;b=a.createRadialGradient(e,f,0,e,f,e>f?e:f)}b.addColorStop(0,c[1]),b.addColorStop(1,c[2])}return b?(a.fillStyle=b,!0):!1},setStroke:function(a){var b=this.strokeColor,c=this.lineWidth;if(b&&c){if(a.strokeStyle=b,a.lineWidth=c,a.lineCap=this.lineCap||"round",a.lineJoin=this.lineJoin||"round",this.snapToPixel&&1===c){var d=this._matrix2d;a.translate(d.tx>=0?.5:-.5,d.ty>=0?.5:-.5)}return!0}return!1},_initGraphics:function(a){var b=a.type,d=b?c.get(b):a;d&&d.init&&d.draw&&(this.graphics=d,d.init.call(this,a))}});return d}),define("display/Filter",["require","exports","module"],function(){var a=function(){};return a.get=function(b,c,d){var e=a.filters[c];return e?e(b,d):void 0},a.filters={grayscale:function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);for(var d,e=c.getImageData(0,0,b.width,b.height),f=e.data,g=0,h=f.length;h>g;g+=4)d=(f[g]+f[g+1]+f[g+2])/3,f[g]=f[g+1]=f[g+2]=d;return c.putImageData(e,0,0),b},brightness:function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");return c.drawImage(a,0,0),c.globalCompositeOperation="lighter",c.drawImage(a,0,0),b},impression:function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);for(var d=c.getImageData(0,0,b.width,b.height),e=d.data,f=["1","0"],g=[],h=0,i=e.length;i>h;h+=16)Math.floor(h/4/b.width)%4||g.push(["rgba("+e[h]+","+e[h+1]+","+e[h+2]+","+e[h+3]+")",f[Math.floor(Math.random()*f.length)],h/4%b.width,Math.floor(h/4/b.width)]);c.clearRect(0,0,b.width,b.height),c.font="40px Microsoft Yahei",c.textBaseline="middle",c.textAlign="center",c.globalAlpha=.25;for(var j,k;g.length;)j=Math.floor(Math.random()*g.length),k=g[j],c.fillStyle=k[0],c.fillText(k[1],k[2],k[3]),g.splice(j,1);return b},rilievo:function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);for(var d,e,f,g=c.getImageData(0,0,b.width,b.height),h=g.data,i=function(a){return 0>a?a=0:a>255&&(a=255),a},j=0,k=h.length;k>j;j+=4)d=j+4,void 0===h[d]&&(d=j),e=Math.floor(h[d]+h[d+1]+h[d+2]-(h[j]+h[j+1]+h[j+2])),f=i(e+128),h[j]=h[j+1]=h[j+2]=f;return c.putImageData(g,0,0),b}},a}),define("display/Bitmap",["require","exports","module","display/DisplayObject","core/Preload","display/Filter"],function(a){var b=a("display/DisplayObject"),c=a("core/Preload"),d=a("display/Filter"),e=!!document.createElement("canvas").getContext,f=document.createElement("div").style,g=""===f.webkitTransform?"webkit":""===f.WebkitTransform?"Webkit":""===f.msTransform?"ms":""===f.MozTransform?"Moz":"ct",h=b.extend({type:"Bitmap",_image:null,_clipRect:null,_srcCanvas:null,_scaleToFit:!1,init:function(a){this._super(a),this._initImage(a)},draw:function(a){if(this._image.complete){var b=this._srcCanvas||this._image;this._clipRect?a.drawImage(b,this._clipRect[0],this._clipRect[1],this.width,this.height,0,0,this.width,this.height):this._scaleToFit?a.drawImage(b,0,0,b.width,b.height,0,0,this.width,this.height):a.drawImage(b,0,0,this.width,this.height,0,0,this.width,this.height)}},applyFilter:function(a,b){if(0===this.renderMode)this.elemStyle[g+"Filter"]=a?a+"("+b+")":"";else if(1===this.renderMode){var c=this._image;if(c.complete)this._srcCanvas=a&&e?d.get(c,a,b):null;else{var f=this;c.addEventListener||(c.addEventListener=c.attachEvent),c.addEventListener("load",function(){f.applyFilter(a,b)})}}},_initImage:function(a){var b=a.image;a.sourceRect?(this._clipRect=a.clipRect||a.sourceRect,this.style("size",{width:this._clipRect[2],height:this._clipRect[3]})):a.scaleToFit&&(this._scaleToFit=a.scaleToFit),0===this.renderMode?(this.elemStyle.backgroundImage="url("+b+")",this.elemStyle.backgroundRepeat="no-repeat",this._clipRect?this.elemStyle.backgroundPosition="-"+this._clipRect[0]+"px -"+this._clipRect[1]+"px":this._scaleToFit&&(this.elemStyle.backgroundSize="100% 100%")):1===this.renderMode&&("string"==typeof b?(c.hasItem(b)||c.loadFile({type:"image",url:b}),this._image=c.getItem(b)):this._image=b)}});return h}),define("display/Text",["require","exports","module","display/DisplayObject"],function(a){var b=a("display/DisplayObject"),c=b.extend({type:"Text",text:null,init:function(a){this._super(a),this._initText(a)},value:function(a){return void 0===a?this.text:(this.text=a,void(0===this.renderMode&&(this.elem.innerHTML=a)))},draw:function(a){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,a.fillStyle=this.textColor,a.fillText(this.text,0,0)},_initText:function(a){this.font=a.font||"20px Microsoft Yahei",this.textAlign=a.align||"left",this.textBaseline=a.baseline||"top",this.textColor=a.color||"black",this.value(a.text||""),0===this.renderMode&&(this.elemStyle.color=this.textColor)}});return c}),define("animation/Timeline",["require","exports","module","core/EventDispatcher","animation/Ease"],function(a){var b=a("core/EventDispatcher"),c=a("animation/Ease"),d=b.extend({_paused:!0,_loop:!1,_targets:null,_currentTarget:null,_deltaTime:-1,_duration:-1,init:function(a){this._paused=!1,this._loop=a?!!a.loop:!1,this._targets=[],this._deltaTime=0,this._duration=0},play:function(a){"number"==typeof a?this.gotoAndPlay(a):this._paused=!1},stop:function(){this._paused=!0},gotoAndPlay:function(a){this._paused=!1,this._deltaTime=a},has:function(a){for(var b=this._targets,c=b.length-1;c>=0;c--)if(b[c]===a)return!0;return!1},get:function(a){return this.has(a)||(this.removeKeyframes(a),a.data("tl_queue",[]),a.data("tl_start",{}),this._targets.push(a)),this._currentTarget=a,this},getTime:function(){return this._deltaTime},addKeyframe:function(a,b,c,d){var e=this._currentTarget,f=e.data("tl_queue"),g=e.data("tl_start");for(var h in a)g[h]=this._clone(e.style(h));f.push([a,b,c||"linear",d]),f.sort(function(a,b){return a[1]-b[1]});for(var i,j=[],k=0,h=0,l=f.length;l>h;h++)i=f[h],j.push({from:k,to:i[1],start:g,end:i[0],easing:i[2],callback:i[3]}),k=i[1],g=this._merge(g,i[0]);return this._duration<k&&(this._duration=k),e.data("tl_steps",j),this},removeKeyframes:function(a){a.data("tl_queue",null),a.data("tl_start",null),a.data("tl_steps",null),a.data("tl_cur_step",null)},update:function(a){if(!this._paused){for(var b,c,d=this._targets,e=this._deltaTime,f=this._duration,g=0,h=d.length;h>g;g++)b=d[g],c=this._getStep(b,e),c&&(this._updateStep(b,c,e),e===f&&c.to===f&&c.callback&&c.callback(e));if(e===f)this._loop?this._deltaTime=0:this.stop(),this.trigger({type:"animationend"});else{var i=e+a;this._deltaTime=i>f?f:i}}},_getStep:function(a,b){var c=a.data("tl_cur_step");if(c){if(b>=c.from&&b<=c.to)return c;b>c.to&&c.callback&&c.callback(b),a.data("tl_cur_step",null)}var d,e=a.data("tl_steps"),f=e[e.length-1].to;if(f>=b)for(var g=0,h=e.length;h>g;g++)if(d=e[g],b>=d.from&&b<=d.to)return a.style(d.start),a.data("tl_cur_step",d),d;return null},_updateStep:function(a,b,d){if(b.to===b.from)return void a.style(b.end);var e=b.to-b.from,f=c.get(b.easing),g=(d-b.from)/e,h=f(g,g,0,1,1),i=b.start,j=b.end;for(var k in j)a._stepStyle(k,{pos:h,start:i[k],end:j[k]})},_clone:function(a){var b;if("object"==typeof a){b={};for(var c in a)b[c]=this._clone(a[c])}else b=a;return b},_merge:function(a,b){var c=this._clone(a);if("object"==typeof b)for(var d in b)if("object"==typeof c[d]&&"object"==typeof b[d])for(var e in b[d])c[d][e]=b[d][e];else c[d]=b[d];else c=b;return c}});return d}),define("animation/Sprite",["require","exports","module","display/DisplayObject","core/Preload"],function(a){var b=a("display/DisplayObject"),c=a("core/Preload"),d=b.extend({type:"Sprite",_paused:!0,_images:null,_imageIndex:-1,_frames:null,_frameIndex:-1,_currentFrame:null,_animations:null,_currentAnimation:null,_deltaTime:-1,init:function(a){this._super(a),this._initSpriteSheet(a.spriteSheet)},play:function(a){"string"==typeof a?this.playAnimation(a):"number"==typeof a?this.gotoAndPlay(a):this._paused=!1},stop:function(){this._paused=!0},gotoAndPlay:function(a){this._paused=!1,this._currentAnimation=null,this._frameIndex=a},gotoAndStop:function(a){this._paused=!0,this._currentAnimation=null,this._frameIndex=a},playAnimation:function(a){this._paused=!1;var b=this._animations[a];b&&(this._currentAnimation=b,this._frameIndex=b.start,this._deltaTime=0)},update:function(a){if(!this._paused){this._updateFrame();var b,c,d,e,f,g=this._currentAnimation;g?(b=g.name,c=g.start,d=g.end,e=g.next,f=g.duration):(b=null,c=0,d=this._frames.length-1,e=!0,f=0);var h;f>0?(this._deltaTime+=a,h=Math.floor((d-c+1)*(this._deltaTime/f)+c)):h=this._frameIndex+1,h>d?("string"==typeof e?this.playAnimation(e):e===!0?this._frameIndex=c:this.stop(),this.trigger({type:"animationend",name:b,animation:g})):this._frameIndex=h}},draw:function(a){var b=this._currentFrame;if(b){var c=this._images[b[4]];c&&c.complete&&a.drawImage(c,b[0],b[1],b[2],b[3],b[5],b[6],b[2],b[3])}},_initSpriteSheet:function(a){this._initImages(a.images),this._initFrames(a.frames),this._initAnimations(a.animations)},_initImages:function(a){this._images=[];for(var b,d=0,e=a.length;e>d;d++)b=a[d],0!==this.renderMode&&(c.hasItem(b)||c.loadFile({type:"image",url:b}),b=c.getItem(b)),this._images.push(b)},_initFrames:function(a,b){if(b||(this._frames=[]),a instanceof Array)for(var c=0,d=a.length;d>c;c++)a[c]instanceof Array?this._frames.push(a[c]):this._initFrames(a[c],!0);else for(var e=0,f=a.rows;f>e;e++)for(var c=0,d=a.cols;d>c&&e*a.cols+c!==a.num;c++)this._frames.push([c*a.width,e*a.height,a.width,a.height,a.image||0,0,0])},_initAnimations:function(a){this._animations={};var b;for(var c in a)b=a[c],this._animations[c]={name:c,start:b[0],end:b[1],next:b[2],duration:b[3]}},_updateFrame:function(){var a=this._currentFrame=this._frames[this._frameIndex];if(a&&((this.width!==a[2]||this.height!==a[3])&&this.style("size",{width:a[2],height:a[3]}),0===this.renderMode)){var b=this.elemStyle;this._imageIndex!==a[4]&&(this._imageIndex=a[4],b.backgroundImage="url("+this._images[a[4]]+")",b.backgroundRepeat="no-repeat"),b.backgroundPosition="-"+a[0]+"px -"+a[1]+"px"}}});return d}),define("extra/ParticleEmitter",["require","exports","module","display/Shape","display/Bitmap"],function(a){var b=a("display/Shape"),c=a("display/Bitmap"),d=function(){};return d.get=function(a){return d.particles[a]},d.particles={rain:{type:"rain",init:function(a){var c,d=a.width,e=a.height;this.particles=[],this.data("fall_width",d),this.data("fall_height",e);for(var f=0,g=a.num||60;g>f;f++)c=new b({renderMode:this.renderMode,pos:{x:Math.floor(Math.random()*d),y:-Math.floor(Math.random()*e)},graphics:{type:"rect",width:f%6===0?3:2,height:f%3===0?28:20,fill:"#FFF"},alpha:Math.floor(3*Math.random())/10+.2}),c.data("fall_speed",Math.floor(25*Math.random())/100+.25),this.particles.push(c),this.add(c)},update:function(a){for(var b,c,d,e=this.particles,f=(this.data("fall_width"),this.data("fall_height")),g=0,h=e.length;h>g;g++)b=e[g],c=b.data("fall_speed")*a,d=b.y,d>f&&(d=-Math.floor(Math.random()*f)),b.style("y",d+c)}},snow:{type:"snow",init:function(a){var d,e,f,g,h=a.width,i=a.height,j=a.image;this.particles=[],this.data("fall_width",h),this.data("fall_height",i);for(var k=0,l=a.num||60;l>k;k++)f={x:Math.floor(Math.random()*h),y:-Math.floor(Math.random()*i)},e=Math.floor(10*Math.random())+15,g=Math.floor(4*Math.random())/10+.6,d=j?new c({renderMode:this.renderMode,pos:f,width:e,height:e,scaleToFit:!0,image:j,alpha:g}):new b({renderMode:this.renderMode,pos:f,alpha:Math.floor(5*Math.random())/10+.3,graphics:{type:"circle",radius:Math.floor(3*Math.random())+4,fill:"#FFF",angle:360}}),d.data("fall_x",d.x),d.data("fall_width",Math.floor(10*Math.random()+10)),d.data("fall_speed",Math.floor(15*Math.random()+15)/1e3),this.particles.push(d),this.add(d)},update:function(a){for(var b,c,d,e,f,g=this.particles,h=(this.data("fall_width"),this.data("fall_height")),i=0,j=g.length;j>i;i++)b=g[i],c=b.data("fall_speed"),d=c*a,e=b.data("fall_x"),f=b.y,f>h&&(b.fallTime=0,f=-Math.floor(Math.random()*h)),b.style("pos",{x:e+Math.sin(f/(2e3*c))*b.data("fall_width"),y:f+d})}},smoke:{type:"smoke",init:function(a){var b=this,d=this.renderMode,e=a.height,f=0,g=e,h="images/smoke.png",i=this.particles=[];this.data("spawn_time",0),this.spawn=function(){var a=Math.floor(6*Math.random())+60,e=new c({renderMode:d,x:f-a/2,y:g,width:a,height:a,image:h,scaleToFit:!0,alpha:.8});e.data({life_time:0,now_size:1,start_size:30,vr:(3*Math.random()+3)/10,vsize:(3*Math.random()+3)/10,vx:0,vy:-Math.floor(4*Math.random()+20)/10}),e.style({transform:{rotate:Math.floor(360*Math.random())}}),i.push(e),b.add(e)}},update:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this.particles,n=this.data("spawn_time");n>90?(this.spawn(),this.data("spawn_time",0)):this.data("spawn_time",n+a);for(var o=m.length-1;o>=0;o--)b=m[o],c=b.data("life_time"),c>6e3?(m.splice(o,1),this.remove(b)):(i=b.x,j=b.y,k=b.transform.rotate,l=b.alpha,d=b.width,e=b.data("vx"),f=b.data("vy"),g=b.data("vr"),h=b.data("vsize"),d+=h,b.data("life_time",c+a),b.style({x:i+e,y:j+f,size:{width:d,height:d},transform:{rotate:k-g},alpha:l-.0035}))}},fireworks:{type:"fireworks",init:function(a){var b,d=a.list,e=a.image,f=a.num,g=0,h=0;this.particles=[];for(var i=0;(f||60)>i;i++){var j=d.length,k=Math.floor(Math.random()*j);b=new c({renderMode:this.renderMode,image:e,sourceRect:d[k]});var l=360*Math.random()*Math.PI/180,m=360*Math.random();b.data("angle",l);var n=.1*Math.random()+.2;b.data("speed",n),b.style({x:g,y:h,transform:{rotate:m}}),this.particles.push(b),this.add(b)}},update:function(a){for(var b,c,d,e,f,g,h,i,j,k=this.particles,l=0,m=k.length;m>l;l++)b=k[l],c=b.data("angle"),d=b.data("speed"),e=b.x,f=b.y,g=b.alpha,h=d*a,i=h*Math.cos(c),j=h*Math.sin(c),e+=i,f+=j,b.style({x:e,y:f,alpha:g-.01});0>=g&&(this.stop(),this.trigger({type:"animationend"}))}}},d}),define("extra/ParticleSystem",["require","exports","module","display/DisplayObject","extra/ParticleEmitter"],function(a){var b=a("display/DisplayObject"),c=a("extra/ParticleEmitter"),d=b.extend({type:"ParticleSystem",emitter:null,particles:null,_paused:!0,init:function(a){this._super(a),this._initParticle(a.particle)},stop:function(){this._paused=!0},update:function(a){this._paused||this.emitter&&this.emitter.update.call(this,a)},_initParticle:function(a){var b=a.type,d=b?c.get(b):a;d&&d.init&&d.update&&(this._paused=!1,this.emitter=d,d.init.call(this,a))}});return d}),define("extra/SkeletalAnimation",["require","exports","module","display/DisplayObject","display/Bitmap","animation/Timeline"],function(a){var b=a("display/DisplayObject"),c=a("display/Bitmap"),d=a("animation/Timeline"),e=b.extend({type:"SkeletalAnimation",_paused:!0,_bones:null,_animations:null,_currentAnimation:null,_timeline:null,init:function(a){this._super(a),this._initBones(a)},play:function(a){"string"==typeof a?this.playAnimation(a):this._paused=!1},stop:function(){this._paused=!0},playAnimation:function(a){this._paused=!1;var b=this._animations[a];b&&(this._currentAnimation=b,this._timeline=this._initTimeline(b))},update:function(a){this._paused||this._timeline&&this._timeline.update(a)},_initBones:function(a){this._bones={},this._animations={};for(var d,e,f=a.bones,g=a.animations,h=0,i=f.length;i>h;h++)d=f[h],e=d.image?new c({renderMode:this.renderMode,x:0,y:0,width:d.width,height:d.height,image:d.image}):new b({renderMode:this.renderMode,x:0,y:0,width:d.width,height:d.height}),d.parent||this.add(e),this._bones[d.tag]=e;for(var h=0,i=f.length;i>h;h++)d=f[h],d.parent&&this._bones[d.parent].add(this._bones[d.tag]);for(var h in g)this._animations[h]=g[h]},_initTimeline:function(a){for(var b,c,e,f,g=new d({loop:!0}),h=0,i=a.length;i>h;h++){b=a[h],c=this._bones[b.tag],e=b.frames,g.get(c);for(var j=0,k=e.length;k>j;j++)f=e[j],g.addKeyframe(f,f.time)}return g}});return e}),define("cartoon",["require","exports","module","base","core/Class","core/Ticker","core/Loader","core/Preload","display/StyleSheet","display/DisplayObject","display/Container","display/Canvas","display/Graphics2D","display/Shape","display/Filter","display/Bitmap","display/Text","animation/Ease","animation/Tween","animation/Timeline","animation/Sprite","extra/ParticleEmitter","extra/ParticleSystem","extra/SkeletalAnimation"],function(a){var b=a("base");return b.expand({Class:a("core/Class"),Ticker:a("core/Ticker"),Loader:a("core/Loader"),Preload:a("core/Preload"),StyleSheet:a("display/StyleSheet"),DisplayObject:a("display/DisplayObject"),Container:a("display/Container"),Canvas:a("display/Canvas"),Graphics2D:a("display/Graphics2D"),Shape:a("display/Shape"),Filter:a("display/Filter"),Bitmap:a("display/Bitmap"),Text:a("display/Text"),Ease:a("animation/Ease"),Tween:a("animation/Tween"),Timeline:a("animation/Timeline"),Sprite:a("animation/Sprite"),ParticleEmitter:a("extra/ParticleEmitter"),ParticleSystem:a("extra/ParticleSystem"),SkeletalAnimation:a("extra/SkeletalAnimation")}),b});